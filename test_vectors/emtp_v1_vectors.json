{
  "schema": "emtp_v1",
  "version": "1.0",
  "description": "EMTP v1 conformance test vectors",
  "domain_prefix": "emtp|v1|",
  "keys": [
    {
      "kid": "test-2026-01",
      "key_hex": "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f",
      "key_b64": "AAECAwQFBgcICQoLDA0ODxAREhMUFRYXGBkaGxwdHh8=",
      "note": "Fixed 256-bit key for test vectors only"
    }
  ],
  "normalization_vectors": [
    {
      "description": "Basic name normalization with honorific",
      "input": "MR. JRR Tolkien",
      "expected_normalized": "jrr tolkien",
      "expected_tokens": {
        "first": "jrr",
        "middles": [],
        "last": "tolkien",
        "suffix": ""
      }
    },
    {
      "description": "Name with periods in initials",
      "input": "J. R. R. Tolkien",
      "expected_normalized": "j r r tolkien",
      "expected_tokens": {
        "first": "j",
        "middles": ["r", "r"],
        "last": "tolkien",
        "suffix": ""
      }
    },
    {
      "description": "Name with suffix",
      "input": "John Tolkien Sr.",
      "expected_normalized": "john tolkien",
      "expected_tokens": {
        "first": "john",
        "middles": [],
        "last": "tolkien",
        "suffix": "sr"
      }
    },
    {
      "description": "Name with suffix spelled out",
      "input": "John Tolkien Senior",
      "expected_normalized": "john tolkien",
      "expected_tokens": {
        "first": "john",
        "middles": [],
        "last": "tolkien",
        "suffix": "sr"
      }
    },
    {
      "description": "Phone normalization - US format",
      "input": "(212) 555-0100",
      "expected_normalized": "2125550100"
    },
    {
      "description": "Phone normalization - with country code",
      "input": "+1-212-555-0100",
      "expected_normalized": "2125550100",
      "note": "Leading 1 stripped for 11-digit US numbers"
    },
    {
      "description": "Address normalization",
      "input": "20 Northmoor Rd, Oxford",
      "expected_normalized": "20 northmoor rd oxford"
    },
    {
      "description": "DOB validation",
      "input": "1892-01-03",
      "expected_normalized": "1892-01-03"
    },
    {
      "description": "ID number extraction",
      "input": "SSN 123-45-6789",
      "expected_variants": ["6789", "56789", "456789"]
    }
  ],
  "tuple_vectors": [
    {
      "description": "Basic name+dob tuple",
      "inputs": {
        "name": "jrr tolkien",
        "dob": "1892-01-03"
      },
      "expected_tuple": "name=jrr tolkien|dob=1892-01-03"
    },
    {
      "description": "Name+dob+phone tuple",
      "inputs": {
        "name": "jrr tolkien",
        "dob": "1892-01-03",
        "phone": "2125550100"
      },
      "expected_tuple": "name=jrr tolkien|dob=1892-01-03|phone=2125550100"
    },
    {
      "description": "Full tuple with all fields",
      "inputs": {
        "name": "jrr tolkien",
        "dob": "1892-01-03",
        "phone": "2125550100",
        "address": "20 northmoor rd oxford",
        "id": "6789"
      },
      "expected_tuple": "name=jrr tolkien|dob=1892-01-03|phone=2125550100|address=20 northmoor rd oxford|id=6789"
    },
    {
      "description": "Phone+dob tuple (no name)",
      "inputs": {
        "dob": "1892-01-03",
        "phone": "2125550100"
      },
      "expected_tuple": "dob=1892-01-03|phone=2125550100"
    }
  ],
  "token_vectors": [
    {
      "description": "Basic token with domain separation",
      "tuple": "name=jrr tolkien|dob=1892-01-03",
      "domain_separated_message": "emtp|v1|name=jrr tolkien|dob=1892-01-03",
      "key_kid": "test-2026-01",
      "expected_token": "17d878e5adfb971b9aad5c15b0aa85fbdd74605a4809423bb3cc41399d2ac427"
    },
    {
      "description": "Token with phone",
      "tuple": "name=jrr tolkien|dob=1892-01-03|phone=2125550100",
      "domain_separated_message": "emtp|v1|name=jrr tolkien|dob=1892-01-03|phone=2125550100",
      "key_kid": "test-2026-01",
      "expected_token": "a43f1e894da995ec878c0edd18683179d854e827c135dacc3dd07f09b226832d"
    }
  ],
  "match_vectors": [
    {
      "description": "Two records that should match via shared tuple",
      "record_a": {
        "full_name": "MR. JRR Tolkien",
        "dob": "1892-01-03",
        "phones": ["(212) 555-0100"]
      },
      "record_b": {
        "full_name": "J.R.R. Tolkien",
        "dob": "1892-01-03",
        "phones": ["+1 212 555 0100"]
      },
      "shared_tuples": [
        "name=jrr tolkien|dob=1892-01-03",
        "name=jrr tolkien|dob=1892-01-03|phone=2125550100"
      ],
      "note": "J.R.R. expands to 'jrr' via initial-collapsing variant"
    },
    {
      "description": "Records with name variation that should still match",
      "record_a": {
        "full_name": "John Ronald Tolkien",
        "dob": "1892-01-03"
      },
      "record_b": {
        "full_name": "John Tolkien",
        "dob": "1892-01-03"
      },
      "shared_tuples": [
        "name=john tolkien|dob=1892-01-03"
      ],
      "note": "First+last variant matches when middle is dropped"
    }
  ],
  "expansion_vectors": [
    {
      "description": "Expected tuple expansion for a full record",
      "input": {
        "full_name": "John Ronald Reuel Tolkien Sr",
        "dob": "1892-01-03",
        "phones": ["(212) 555-0100"],
        "addresses": ["20 Northmoor Rd Apt 5, Oxford"],
        "idnos": ["123-45-6789"]
      },
      "expected_name_variants": [
        "john ronald reuel tolkien",
        "john tolkien",
        "john tolkien sr",
        "j tolkien",
        "j r r tolkien"
      ],
      "expected_phone_variants": [
        "2125550100"
      ],
      "expected_address_variants": [
        "20 northmoor rd apt 5 oxford",
        "20 northmoor rd oxford"
      ],
      "expected_id_variants": [
        "6789",
        "56789",
        "456789"
      ],
      "minimum_tuple_count": 20,
      "maximum_tuple_count": 256
    }
  ]
}
